from bs4 import BeautifulSoup
import re
import os
import requests
import unittest
import sqlite3
import json

API_key = "e8128ade33840f3a6e329355e63ee69cae8d5dd3"
parameters = {"key": API_key}
query_url = "https://api.census.gov/data/2020/dec/ddhca"

#Function to CALL THE API KEY
def scrape_data():
    url = f'{query_url}?get={"what we want"}&for=state:*&key = {API_key}'
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        return data
    else:
        print ("Could not access Census data")
        return None

print (scrape_data())

def set_up_database(data_name):
    path = os.path.dirname(os.path.abspath(__file__))
    #conn = sqlite3.connect('your_database.db')
    conn = sqlite3.connect(path + "/" + data_name)
    return conn
        

    





def main():
    data = scrape_data()
    if data:
        conn = set_up_database("demographic_info.db")
        cur = conn.cursor()
        print("Data stored successfully!")


if __name__ == "__main__":
    main()
    unittest.main(verbosity=2)